
    
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Python使用Azure AD账号密码连接SQL Server - Lijiahong</title>
<meta name="keywords" content="lijiahong" />
<meta name="description" content="content" />
<link href="https://lijiahong.com/style.css" rel="stylesheet" type="text/css" />
</head>

<body>
<div id="wrap">
	
<div id="header">
    <div class="logo"><a href="https://lijiahong.com">Lijiahong</a><p>只是一点学习笔记而已</p></div>
    <div id="navigation">
	
		<ul id="nav">
	<li><a href="https://lijiahong.com/map.html">我的足迹</a></li>
			<li class="common"><a href="https://lijiahong.com" >我的笔记</a></li>
		</ul>

    </div>
</div>

<div class="line" style="height:1px;width:100%;border-bottom:1px solid blue;">

</div>

<div id="content">
<div id="main_page">
<div id="article">
	<h1>Python使用Azure AD账号密码连接SQL Server</h1>

	<div class="text"><pre>import pyodbc
# Some other example server values are
# server = 'localhost\sqlexpress' # for a named instance
# server = 'myserver,port' # to specify an alternate port

server = 'tcp:abc018.database.windows.net'
database = 'abc01'
username = 'HDOAS01@bib.com'
password = 'Z$PV27VjlQ'

cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server +';DATABASE='+database+';ENCRYPT=yes;UID='+username
+';Authentication=ActiveDirectoryPassword;PWD='+ password)
cursor = cnxn.cursor()

query="select name from sys.databases"
cursor.execute(query)
rows = cursor.fetchall()

print(rows)
</pre>
<pre></pre>
<pre><a href="https://learn.microsoft.com/en-us/sql/connect/odbc/using-azure-active-directory?view=sql-server-ver16#new-andor-modified-dsn-and-connection-string-keywords">Using Azure Active Directory with the ODBC Driver - ODBC Driver for SQL Server | Microsoft Learn</a></pre>
<pre></pre>
<pre></pre>
<table aria-label="Table 1" class="table table-sm">
	<thead>
		<tr>
			<th>
				Name
			</th>
			<th>
				Values
			</th>
			<th>
				Default
			</th>
			<th>
				Description
			</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<code>Authentication</code> 
			</td>
			<td>
				(not set), (empty string), <code>SqlPassword</code>, <code>ActiveDirectoryPassword</code>, <code>ActiveDirectoryIntegrated</code>, <code>ActiveDirectoryInteractive</code>, <code>ActiveDirectoryMsi</code>, <code>ActiveDirectoryServicePrincipal</code> 
			</td>
			<td>
				(not set)
			</td>
			<td>
				Controls the authentication mode.
				<div class="has-inner-focus">
					<table aria-label="Table 2" class="table table-sm">
						<tbody>
							<tr>
								<th>
									Value
								</th>
								<th>
									Description
								</th>
							</tr>
							<tr>
								<td>
									(not set)
								</td>
								<td>
									Authentication mode determined by other keywords (existing legacy connection options.)
								</td>
							</tr>
							<tr>
								<td>
									(empty string)
								</td>
								<td>
									(Connection string only.) Override and unset an <code>Authentication</code> value set in the DSN.
								</td>
							</tr>
							<tr>
								<td>
									<code>SqlPassword</code> 
								</td>
								<td>
									Directly authenticate to a SQL Server instance using a username and password.
								</td>
							</tr>
							<tr>
								<td>
									<code>ActiveDirectoryPassword</code> 
								</td>
								<td>
									Authenticate with an Azure Active Directory identity using a username and password.
								</td>
							</tr>
							<tr>
								<td>
									<code>ActiveDirectoryIntegrated</code> 
								</td>
								<td>
									<em>Windows, and Linux/Mac 17.6+, driver only</em>. Authenticate with an Azure Active Directory identity using integrated authentication.
								</td>
							</tr>
							<tr>
								<td>
									<code>ActiveDirectoryInteractive</code> 
								</td>
								<td>
									<em>Windows driver only</em>. Authenticate with an Azure Active Directory identity using interactive authentication.
								</td>
							</tr>
							<tr>
								<td>
									<code>ActiveDirectoryMsi</code> 
								</td>
								<td>
									Authenticate with Azure Active Directory identity using managed identity authentication. For user-assigned identity, UID is set to the object ID of the user identity.
								</td>
							</tr>
							<tr>
								<td>
									<code>ActiveDirectoryServicePrincipal</code> 
								</td>
								<td>
									(17.7+) Authenticate with Azure Active Directory identity using service principal authentication. UID is set to the client ID of the service principal. PWD is set to the client secret.
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<code>Encrypt</code> 
			</td>
			<td>
				(not set), <code>Yes</code>/<code>Mandatory</code>(18.0+), <code>No</code>/<code>Optional</code>(18.0+), <code>Strict</code>(18.0+)
			</td>
			<td>
				(see description)
			</td>
			<td>
				Controls encryption for a connection. If the pre-attribute value of the <code>Authentication</code> setting isn't <em><code>none</code></em> in the DSN or connection string, the default is <code>Yes</code>. The default is also <code>Yes</code> in versions 18.0.1+. Otherwise, the default is <code>No</code>. If the attribute <code>SQL_COPT_SS_AUTHENTICATION</code> overrides the pre-attribute value of <code>Authentication</code>, explicitly set the value of Encryption in the DSN or connection string or connection attribute. The pre-attribute value of Encryption is <code>Yes</code> if the value is set to <code>Yes</code> in either the DSN or connection string.
			</td>
		</tr>
	</tbody>
</table></div>

	</div>

</div>
﻿</div>

<div style="clear:both;"></div>
<div id="footer">
<p><a href="https://lijiahong.com">@Lijiahong</a></p>
 
</div>
</body>
</html>


    